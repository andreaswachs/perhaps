# Production values for Perhaps Helm chart
# Usage: helm install perhaps ./charts/perhaps -f charts/perhaps/values-production.yaml

global:
  image:
    repository: ghcr.io/perhaps-finance/perhaps
    tag: stable
    pullPolicy: IfNotPresent

web:
  replicaCount: 3
  resources:
    requests:
      memory: "512Mi"
      cpu: "250m"
    limits:
      memory: "2Gi"
      cpu: "2000m"
  pdb:
    enabled: true
    minAvailable: 2
  hpa:
    enabled: true
    minReplicas: 3
    maxReplicas: 20
    targetCPUUtilizationPercentage: 70
  defaultAntiAffinity: true

worker:
  enabled: true
  replicaCount: 3
  concurrency: 10
  resources:
    requests:
      memory: "512Mi"
      cpu: "250m"
    limits:
      memory: "1Gi"
      cpu: "1000m"
  pdb:
    enabled: true
    minAvailable: 2
  hpa:
    enabled: true
    minReplicas: 2
    maxReplicas: 10
    targetCPUUtilizationPercentage: 70
  defaultAntiAffinity: true

ingress:
  enabled: true
  className: nginx
  annotations:
    cert-manager.io/cluster-issuer: letsencrypt-prod
  hosts:
    - host: perhaps.example.com
      paths:
        - path: /
          pathType: Prefix
  tls:
    - secretName: perhaps-tls
      hosts:
        - perhaps.example.com

config:
  railsEnv: production
  forceSSL: "true"
  assumeSSL: "true"
